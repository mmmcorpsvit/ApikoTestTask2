{"version":3,"sources":["src/index.js"],"names":["document","getElementById","innerHTML","BASE_URL","MOVIE_TYPES","popular","name","url","rated","state","ajax","api_url","aditional_params","onError","undefined","onDone","query_params","API_KEY","xhr","XMLHttpRequest","addEventListener","readyState","DONE","responseText","JSON","parse","onerror","open","setRequestHeader","send","movie_type_view","active_movie_type","res","index","mtype","active","handleMovieTypeClick","obj","value","movie_page","home_view","render_pagination","data","handler","page","total_pages","movie_url","movies_type","alert","home_render","handleMoviePage","getAttribute","root_id","root_id_element","results","movies","pagination","total_results","movie","id","overview","poster_path","modal_view","activity_page","object","btn","onclick","handleMovie","path","routher","view","setInitialState","main"],"mappings":";AAIAA,SAASC,eAAe,OAAOC,UAE/B,8CAEA,IAAMC,EAAW,gCAEXC,EAAc,CAChBC,QAAS,CACLC,KAAM,mBACNC,IAAQJ,GAAAA,OAAAA,EAAL,eAEPK,MAAO,CACHF,KAAM,qBACNC,IAAQJ,GAAAA,OAAAA,EAAL,kBAIPM,EAAQ,GAgBZ,SAASC,EAAKC,EAASC,GAAkBC,IAAAA,EAAUC,UAAAA,OAAAA,QAAAA,IAAAA,UAAAA,GAAAA,UAAAA,QAAAA,EAAWC,EAASD,UAAAA,OAAAA,QAAAA,IAAAA,UAAAA,GAAAA,UAAAA,QAAAA,EAK/DE,EAA0CC,2BAAAA,OAJ9B,oCAKZL,IACAI,GAAgBJ,GAGhBL,IAAAA,EAASI,GAAAA,OAAAA,GAAUK,OAAAA,GACnBE,EAAM,IAAIC,eAGdD,EAAIE,iBAAiB,mBAAoB,WACjC,KAAKC,aAAe,KAAKC,OACnB,KAAKC,aAGPR,GACAA,EAAOS,KAAKC,MAAM,KAAKF,kBAOnCL,EAAIQ,QAAUb,EAEdK,EAAIS,KAAK,MAAOpB,GAQhBW,EAAIU,iBAAiB,SAAU,KAG/BV,EAAIU,iBAAiB,eAAgB,oBAYrCV,EAAIW,KAhDO,MAsDf,SAASC,EAAgBC,GAGjBC,IAAAA,EAAM,GAEL,IAAA,IAAIC,KAAS7B,EAAa,CACvB8B,IAAAA,EAAQ9B,EAAY6B,GACpBE,EAAS,GACTJ,IAAsBE,IACtBE,EAAS,qBAIbH,GAAuFC,gFAAAA,OAAAA,EAAiDE,6CAAAA,OAAAA,EAC1HD,2BAAAA,OAAAA,EAAM5B,KADpB,8BAmBG0B,OAdPA,EAKMA,8IAAAA,OAAAA,EALN,8WAiBJ,SAASI,EAAqBC,GAE1B5B,EAAK,YAAkB4B,EAAIC,MAC3B7B,EAAM8B,WAAa,EACnBC,IAKJ,SAASC,EAAkBC,GACnBC,IAAAA,EAAJ,kDAEIX,EAAgBW,UAAAA,OAAAA,EAApB,iCAiBOX,OAfHU,EAAKE,KAAO,EAAI,IAChBZ,GAAiBW,UAAAA,OAAAA,EAAsBD,gBAAAA,OAAAA,EAAKE,KAAO,EAAnD,qBAIAF,EAAKE,KAAO,EAAIF,EAAKG,cACrBb,GAAiBW,UAAAA,OAAAA,EAAsBD,gBAAAA,OAAAA,EAAKE,KAAO,EAAnD,oBAGJZ,GAAiBW,UAAAA,OAAAA,EAAsBD,gBAAAA,OAAAA,EAAKG,YAGpCH,2CAAAA,OAAAA,EAAKE,KAEEF,iCAAAA,OAAAA,EAAKG,aAIxB,SAASL,EAAUE,GACXI,IAAAA,EAAY1C,EAAYK,EAAMsC,aAAlB,IACZf,EAAM,CAAUvB,MAAAA,GAEhBG,EAAmB,GAEnBH,EAAM8B,aACN3B,EAA4BH,SAAAA,OAAAA,EAAM8B,aAItC7B,EACIoC,EACAlC,EACAC,QAAU,WACNmC,MAAM,gBAGVjC,OAAS,SAAU2B,GACfV,EAAG,KAAWU,EAEdO,EAAYjB,KAMxB,SAASkB,EAAgBb,GAOd,OAHP5B,EAAM8B,WAAaF,EAAIc,aAAa,aAEpCX,KACO,EAIX,SAASS,EAAYP,GAAMU,IAAAA,EAAUtC,UAAAA,OAAAA,QAAAA,IAAAA,UAAAA,GAAAA,UAAAA,QAAAA,EAE7BuC,EAAkB,WACNvC,IAAZsC,IACAC,EAAkBD,GAGtBpD,SAASC,eAAeoD,GAAiBnD,UAAY,GAEjDyC,IAEAX,EAKAsB,EAAUZ,EAAKA,KAAL,QACVa,EAAS,GAETC,EAAa,CACbZ,KAAMF,EAAKA,KAAL,KACNe,cAAef,EAAKA,KAAL,cACfG,YAAaH,EAAKA,KAAL,aAGZ,IAAA,IAAIT,KAASqB,EAAS,CACnBI,IAAAA,EAAQJ,EAAQrB,GACpBsB,GACiBb,4CAAAA,OAAAA,EAAKjC,MAAMsC,YACbW,6BAAAA,OAAAA,EAAMC,GACJD,+BAAAA,OAAAA,EAAMpD,KACFoD,kCAAAA,OAAAA,EAAME,SAERF,8CAAAA,OAAAA,EAAMG,YAEnBlB,oCAAAA,OA1BV,4CA0BqBe,KAAAA,OAAAA,EAAMpD,KARvB,aAYJ0B,EACEF,SAAAA,OAAAA,EAAgBY,EAAKjC,MAAMsC,aAGvBQ,0BAAAA,OAAAA,EAKId,sFAAAA,OAAAA,EAAkBe,GAT5B,qCAyBAxD,SAASC,eAAe,OAAOC,UAAY8B,EAG/C,SAAS8B,EAAWpB,GACZ9B,IAMAoB,EAAM,GAqBH,MAlBoB,gBAAvBU,EAAKqB,gBACL/B,EACUU,qBAAAA,OAAAA,EAAKsB,OAAOb,aAAa,WACvBT,6BAAAA,OAAAA,EAAKsB,OAAOb,aAAa,aACrBT,qCAAAA,OAAAA,EAAKsB,OAAOb,aAAa,iBAC3BT,mCAAAA,OAAAA,EAAKsB,OAAOb,aAAa,eAJvC,2BAQehD,GAAAA,OAAAA,EAAf,eAMJH,SAASC,eAAe,cAAcC,UAAY8B,EAElDiC,IAAIC,QAAQxB,IACL,EAoCX,SAASyB,EAAY9B,GAUjByB,EALU,CACNC,cAAe,cACfC,OAAQ3B,IAOhB,SAAS+B,EAAKC,EAASC,EAAMhE,GAClB,MAAA,CACQ+D,QAAAA,EACHC,KAAAA,EACAhE,KAAAA,GAYhB,SAASiE,EAAgB7B,GACrBjC,EAAQiC,EAGZ,SAAS8B,IACLD,EAAgB,CACG,YAAA,YAKnB/B,IAQJgC","file":"src.2e989133.js","sourceRoot":"..","sourcesContent":["// import \"./styles.css\";\r\n// import './themoviedb';\r\n// import './utils';\r\n\r\ndocument.getElementById(\"app\").innerHTML = `<h1>Please wait, loading...</h1><div></div>`;\r\n\r\n// https://api.themoviedb.org/3/tv/top_rated?api_key=520586ec107ebeef4af3a185ee10ae9b&language=en-US&page=1\r\n\r\nconst BASE_URL = 'https://api.themoviedb.org/3/';\r\n\r\nconst MOVIE_TYPES = {\r\n    popular: {\r\n        name: 'Popular TV shows',\r\n        url: `${BASE_URL}tv/popular`\r\n    },\r\n    rated: {\r\n        name: 'Top Rated TV shows',\r\n        url: `${BASE_URL}tv/top_rated`\r\n    }\r\n};\r\n\r\nvar state = {};\r\n\r\n// *********************************** APP The Movie DB ****************************************\r\n\r\n\r\n// *********************************** APP The Movie DB ****************************************\r\n\r\n\r\n// ****************************************     Utils   ********************************\r\n// class ajax {\r\n//     onBeforeSend = undefined;\r\n//     onError = undefined;\r\n//\r\n//     on\r\n// }\r\n\r\nfunction ajax(api_url, aditional_params, onError = undefined, onDone = undefined) {\r\n    const API_KEY = '520586ec107ebeef4af3a185ee10ae9b';\r\n\r\n    var res = undefined;\r\n    var data = \"{}\";\r\n    var query_params = `?language=en-US&api_key=${API_KEY}`;\r\n    if (aditional_params) {\r\n        query_params += aditional_params;\r\n    }\r\n\r\n    var url = `${api_url}${query_params}`;\r\n    var xhr = new XMLHttpRequest();\r\n    // xhr.withCredentials = true;\r\n\r\n    xhr.addEventListener(\"readystatechange\", function () {\r\n        if (this.readyState === this.DONE) {\r\n            res = this.responseText;\r\n            // console.log(this.responseText);\r\n            // document.getElementById(\"app\").innerHTML = res['page'];\r\n            if (onDone) {\r\n                onDone(JSON.parse(this.responseText));\r\n            }\r\n        }\r\n    });\r\n\r\n    // TODO: refactor CORS\r\n\r\n    xhr.onerror = onError;\r\n    // xhr.onloadend = onDone;\r\n    xhr.open(\"GET\", url);\r\n\r\n    // xhr.open(\"GET\", `https://api.themoviedb.org/3/tv/top_rated${query_params}`);\r\n\r\n\r\n    // xhr.open(\"GET\", `https://api.themoviedb.org/3/search/movie?api_key=${API_KEY}&query=Ponyo&year=2008`);\r\n    // xhr.open(\"GET\", `https://api.themoviedb.org/3/authentication/token/validate_with_login?api_key=${API_KEY}`);\r\n\r\n    xhr.setRequestHeader(\"Origin\", \"*\");\r\n    // xhr.setRequestHeader(\"Origin\", location.origin);\r\n    // xhr.setRequestHeader(\"Access-Control-Allow-Origin\", \"*\");\r\n    xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n    // xhr.setRequestHeader(\"Accept\", \"application/json\");\r\n    // xhr.setRequestHeader(\"Access-Control-Allow-Origin\", \"*\");\r\n    // xhr.setRequestHeader(\"Access-Control-Allow-Headers\", \"*\");\r\n    // xhr.setRequestHeader(\"Access-Control-Allow-Credentials\", \"true\");\r\n    // xhr.setRequestHeader(\"Access-Control-Allow-Methods\", \"GET,HEAD,OPTIONS,POST,PUT,DELETE\");\r\n    // xhr.setRequestHeader(\"Access-Control-Allow-Headers\", \"Access-Control-Allow-Headers, Origin,Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers\");\r\n    // xhr.setRequestHeader('Access-Control-Allow-Headers', '*');\r\n    // xhr.setRequestHeader('Content-type', 'application/ecmascript');\r\n    // xhr.setRequestHeader('Access-Control-Allow-Origin', '*');\r\n\r\n\r\n    xhr.send(data);\r\n}\r\n\r\n// ****************************************     Utils   ********************************\r\n\r\n// ************************* Movie Type Selector ***************************************\r\nfunction movie_type_view(active_movie_type) {\r\n    // var res = '';\r\n\r\n    var res = '';\r\n\r\n    for (let index in MOVIE_TYPES) {\r\n        let mtype = MOVIE_TYPES[index];\r\n        let active = '';\r\n        if (active_movie_type === index) {\r\n            active = 'checked=\"checked\"'\r\n        }\r\n\r\n\r\n        res += `<label><input class=\"movie_type_radio\" type=\"radio\" name=\"movie_type\" value=\"${index}\" onchange=\"handleMovieTypeClick(this);\" ${active}>\r\n                    ${mtype.name}\r\n                </label>`;\r\n    }\r\n\r\n    res = `\r\n    <div>\r\n \r\n    <form id=\"select_movie_type\" action=\"\" method=\"post\">\r\n        <fieldset> <legend><b>Movie type:</b></legend>\r\n        ${res}\r\n<!--        <label><input type=\"radio\" name=\"movie_type\" value=\"popular\" checked=\"checked\">Popular TV shows</label>-->\r\n<!--        <label><input type=\"radio\" name=\"movie_type\" value=\"rated\">Top Rated TV shows</label>-->\r\n        </fieldset>\r\n<!--        <p><input type=\"reset\"> <input type=\"submit\"></p>-->\r\n        </form>\r\n    </div>\r\n    `;\r\n\r\n    return res;\r\n}\r\n\r\nfunction handleMovieTypeClick(obj) {\r\n    // let movie_type = obj.value;\r\n    state['movies_type'] = obj.value;\r\n    state.movie_page = 1;\r\n    home_view();\r\n}\r\n\r\n// ************************* Movie Type Selector ***************************************\r\n\r\nfunction render_pagination(data) {\r\n    let handler = `href=\"#\" onclick=\"return handleMoviePage(this)\"`;\r\n\r\n    let res = `<li><a ${handler} data-page=\"1\">First</a></li>`;\r\n\r\n    if (data.page - 1 > 1) {\r\n        res += `<li><a ${handler} data-page=\"${data.page - 1}\">Prior</a></li>`;\r\n    }\r\n\r\n\r\n    if (data.page + 1 < data.total_pages) {\r\n        res += `<li><a ${handler} data-page=\"${data.page + 1}\">Next</a></li>`;\r\n    }\r\n\r\n    res += `<li><a ${handler} data-page=\"${data.total_pages}\">Last</a></li>\r\n\r\n    <br>\r\n    page: ${data.page}\r\n    <br>\r\n    total pages: ${data.total_pages}`;\r\n    return res;\r\n}\r\n\r\nfunction home_view(data) {\r\n    let movie_url = MOVIE_TYPES[state.movies_type]['url'];\r\n    let res = {'state': state};\r\n\r\n    let aditional_params = '';\r\n\r\n    if (state.movie_page) {\r\n        aditional_params = `&page=${state.movie_page}`\r\n    }\r\n\r\n\r\n    ajax(\r\n        movie_url,\r\n        aditional_params,\r\n        onError = function () {\r\n            alert('Ajax error!');\r\n        },\r\n\r\n        onDone = function (data) {\r\n            res['data'] = data;\r\n            // home_view(data);\r\n            home_render(res);\r\n        }\r\n    );\r\n\r\n}\r\n\r\nfunction handleMoviePage(obj) {\r\n    // e.preventDefault();\r\n    // e.preventDefault();\r\n    // var href = obj.attr(\"href\");\r\n    state.movie_page = obj.getAttribute('data-page');\r\n\r\n    home_view();\r\n    return false;\r\n}\r\n\r\n\r\nfunction home_render(data, root_id = undefined) {\r\n\r\n    let root_id_element = 'app';\r\n    if (root_id !== undefined) {\r\n        root_id_element = root_id;\r\n    }\r\n\r\n    document.getElementById(root_id_element).innerHTML = '';\r\n\r\n    let handler = `onclick=\"handleMovie(this);return false;\"`;\r\n\r\n    let res = '';\r\n    // alert('Ajax done 3!');\r\n    // res = `Done !!!! Loaded: ${data['total_results']}`;\r\n\r\n\r\n    let results = data.data['results'];\r\n    let movies = '';\r\n\r\n    let pagination = {\r\n        page: data.data['page'],\r\n        total_results: data.data['total_results'],\r\n        total_pages: data.data['total_pages']\r\n    };\r\n\r\n    for (let index in results) {\r\n        let movie = results[index];\r\n        movies += `<li><a href=\"#\" \r\n            data-type=\"${data.state.movies_type}\" \r\n            data-id=\"${movie.id}\" \r\n            data-name=\"${movie.name}\"\r\n            data-overview=\"${movie.overview}\"\r\n            \r\n            data-poster=\"${movie.poster_path}\"\r\n               \r\n            ${handler}>${movie.name}</a></li>`;\r\n    }\r\n\r\n\r\n    res = `\r\n    ${movie_type_view(data.state.movies_type)}\r\n\r\n    <ul>\r\n        ${movies}        \r\n    </ul>\r\n  \r\n    <div class=\"pagination\">\r\n        <ul >\r\n            ${render_pagination(pagination)}\r\n        </ul>\r\n    </div>\r\n    `;\r\n\r\n    // res += `\r\n    // <div id=\"movie_details\">\r\n    // </div>\r\n    //\r\n    // <div id=\"movie_details\">\r\n    // </div>\r\n    //\r\n    // <div id=\"movie_details\">\r\n    // </div>\r\n    // `;\r\n\r\n    document.getElementById(\"app\").innerHTML = res;\r\n}\r\n\r\nfunction modal_view(data) {\r\n    let aditional_params = '';\r\n    // let activity_page = data.activity_page;\r\n\r\n    // var e = data.object.getAttribute('data-name');\r\n    // TODO: poster fix ?\r\n\r\n    let res = '';\r\n    let movie_url = '';\r\n\r\n    if (data.activity_page === 'handleMovie') {\r\n        res = `\r\n            id: ${data.object.getAttribute('data-id')} <br>\r\n            name: ${data.object.getAttribute('data-name')} <br><br>\r\n            overview: ${data.object.getAttribute('data-overview')} <br><br>\r\n            poster: ${data.object.getAttribute('data-poster')} <br>        \r\n        `;\r\n\r\n        // ???????????????\r\n        movie_url = `${BASE_URL}tv/popular`;\r\n\r\n\r\n    }\r\n\r\n\r\n    document.getElementById(\"modal_body\").innerHTML = res;\r\n\r\n    btn.onclick(data);\r\n    return false;\r\n\r\n    ajax(\r\n        movie_url,\r\n        aditional_params,\r\n        onError = function () {\r\n            alert('Ajax error!');\r\n        },\r\n\r\n        onDone = function (data) {\r\n            res['data'] = data;\r\n            // home_view(data);\r\n            home_render(res);\r\n        }\r\n    );\r\n\r\n    // ren\r\n\r\n    // ajax(\r\n    //     movie_url,\r\n    //     aditional_params,\r\n    //     onError = function () {\r\n    //         alert('Ajax error!');\r\n    //     },\r\n    //\r\n    //     onDone = function (data) {\r\n    //         res['data'] = data;\r\n    //         // home_view(data);\r\n    //         home_render(res);\r\n    //     }\r\n    // );\r\n\r\n\r\n}\r\n\r\n\r\nfunction handleMovie(obj) {\r\n\r\n    // По кліку на конкретний елемент списку, потрібно показати заголовок, опис, постер, кількість сезонів, кількість епізодів і список сезонів даного TV show.\r\n    // btn.onclick(obj);\r\n\r\n    let res = {\r\n        activity_page: 'handleMovie',\r\n        object: obj,\r\n    };\r\n\r\n    modal_view(res);\r\n\r\n}\r\n\r\nfunction path(routher, view, name) {\r\n    return {\r\n        'routher': routher,\r\n        'view': view,\r\n        'name': name\r\n    };\r\n}\r\n\r\n// let url = [\r\n//     path('', view = home_view(), name = 'home'),\r\n// ];\r\n\r\n\r\n// movie.init(){}\r\n\r\n\r\nfunction setInitialState(data) {\r\n    state = data;\r\n}\r\n\r\nfunction main() {\r\n    setInitialState({\r\n        'movies_type': 'popular',\r\n    });\r\n\r\n\r\n    // routhing\r\n    home_view();\r\n\r\n    // var app = new app_themoviedb();\r\n    // console.log(app.query('ffdg'));\r\n\r\n\r\n}\r\n\r\nmain();\r\n\r\n\r\n//document.getElementById(\"app\").innerHTML = ajax();\r\n"]}